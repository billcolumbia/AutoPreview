"use strict";!function($){var t=$("body"),o={timer:750,timeout:null,status:"off",isOpen:!1,isUpdating:!1,pendingUpdate:!1,position:0,widths:{wrap:0}},e={wrap:$("#wpwrap"),menu:$("#adminmenu"),post:$("#post-body"),previewBtn:$("#post-preview"),toolbarTabs:!1,toolbarActions:!1,watch:function o(){t.on("click","#post-preview",function(t){t.preventDefault(),n.open()})},setToolbarEls:function t(){this.toolbarTabs=$("#wp-content-editor-tools"),this.toolbarActions=$(".mce-toolbar-grp")}},n={refresh:function t(n){o.isUpdating===!1&&(o.position=u.iframe[0].contentWindow.document.body.scrollTop,u.iframe.css({opacity:0}),e.previewBtn.click(),o.isUpdating=!0)},close:function t(){u.root.css({width:0,opacity:0}),e.wrap.css({width:"100%"}),e.wrap.next().remove(),u.iframe.css({opacity:0}),w(),o.status="off",o.isOpen=!1,o.isUpdating=!1,o.pendingUpdate=!1,o.position=0,i.unwatch()},open:function t(){o.isOpen||(o.status="on",o.isOpen=!0,e.setToolbarEls(),u.watch(),i.watch(),u.root.show(),u.root.css({opacity:1}),f(),u.gutter=$(".gutter-horizontal"),w())}},i={scope:$("#post-body-content"),watch:function t(){this.scope.on("click","input:checkbox, input:radio",d),this.scope.on("keyup","input:text, textarea",c),this.scope.on("change","select, input:hidden",d),s(),r.watchNewEditors(),$(window).on("resize",p)},unwatch:function t(){this.scope.off("click","input:checkbox, input:radio",d),this.scope.off("keyup","input:text, textarea",c),this.scope.off("change","select, input:hidden",d),a(),$(window).off("resize",p)}},s=function t(){$(".wp-editor-container").find("iframe").contents().find("body").on("keyup",c)},a=function t(){$(".wp-editor-container").find("iframe").contents().find("body").off("keyup",c)},r={enabled:function t(){return window.acf&&window.acf.add_action},watchNewEditors:function t(){this.enabled()&&window.acf.add_action("after_duplicate",function(t,o){var e=void 0,n=void 0;n=setTimeout(function(){clearInterval(e),console.log("autopreview: "+o.attr("id")+" - polling timed out")},1500),e=setInterval(function(){var t=o.find(".mce-container iframe");t.length&&(clearInterval(e),clearTimeout(n),t.on("load",function(){t.contents().find("body").on("keyup",c)}))},100)})}},c=function t(){clearTimeout(o.timeout),o.timeout=setTimeout(function(){d()},o.timer)},p=function t(){w(),l()},d=function t(){return!!o.isOpen&&void(o.isUpdating?o.pendingUpdate=!0:n.refresh("queued"))},u={create:function t(){this.root=$("<div/>",{id:"auto-preview"}),this.iframe=$("<iframe/>",{id:"auto-preview-iframe",name:e.previewBtn.attr("target")||"wp-preview"}),this.actionBar=$("<div/>",{class:"auto-preview-actions",text:"Preview:"}),this.closeBtn=$("<button/>",{class:"auto-preview-close button button-primary button-large",text:"Close"}),this.refreshBtn=$("<button/>",{class:"auto-preview-refresh button button-primary button-large",text:"Refresh"}),this.loader=$("<div/>",{class:"loading-spinner"}),this.actionBar.append(this.closeBtn).append(this.refreshBtn),this.root.append(this.actionBar).append(this.iframe).append(this.loader),e.wrap.after(this.root)},watch:function t(){this.closeBtn.on("click",function(t){t.preventDefault(),n.close()}),this.refreshBtn.on("click",function(t){t.preventDefault(),n.refresh("button")}),this.iframe.load(function(){var t=$(this);t[0].contentWindow.document.body.scrollTop=o.position,o.isUpdating=!1,o.pendingUpdate?(o.pendingUpdate=!1,d()):(t.show(),t.css({opacity:1}))})}},f=function t(){Split(["#wpwrap","#auto-preview"],{sizes:[50,50],minSize:250,gutterSize:6,onDrag:function t(){p()},onDragEnd:function t(){p(!0)}})},l=function t(){u.gutter.css({left:o.widths.wrap})},w=function n(){e.toolbarTabs.css("width","100%"),e.toolbarActions.css("width","100%"),o.widths.wrap=e.wrap.width(),o.widths.wrap<851?(e.post.removeClass("columns-2"),e.post.addClass("columns-1")):(e.post.removeClass("columns-1"),e.post.addClass("columns-2")),o.widths.wrap<961?t.addClass("folded"):t.removeClass("folded")},h=function o(){t.addClass("auto-preview-enabled"),u.create(),e.watch()};h()}(jQuery);